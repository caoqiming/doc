## 傅里叶变换简介

傅里叶变换（Fourier Transform）是一种将**时域（或空域）信号**转换到**频域**的数学工具。它揭示了任何复杂的波形都可以分解成一系列不同频率、振幅和相位的正弦波的叠加。简而言之，傅里叶变换就是把信号从其随时间（或空间）变化的表示形式，转换成其所包含的各种频率成分的表示形式。

### 基本原理

傅里叶变换的核心思想是**任何周期信号都可以表示为一系列正弦波和余弦波的加权和**。对于非周期信号，它则可以被视为周期无限大的周期信号，从而通过积分的形式来表示其频率成分。

这种转换的意义在于，在时域中看似复杂的信号，在频域中可能会变得非常简单和有规律。这使得我们能够分析信号的频率特性，例如识别信号中的主要频率、滤除噪声或进行数据压缩。

### 公式

傅里叶变换有两种主要形式：连续傅里叶变换和离散傅里叶变换。

#### 1. 连续傅里叶变换 (Continuous Fourier Transform, CFT)

对于一个连续时间信号 $x(t)$，其傅里叶变换 $X(\omega)$ 定义为：

$$X(\omega) = \int_{-\infty}^{\infty} x(t) e^{-j\omega t} dt$$

其中：

- $x(t)$ 是时域信号。
- $X(\omega)$ 是频域信号，代表在频率 $\omega$ 处的幅度。
- $j$ 是虚数单位，$\sqrt{-1}$。
- $\omega$ 是角频率，单位是弧度/秒。

其逆傅里叶变换（将频域信号转换回时域）定义为：

$$x(t) = \frac{1}{2\pi} \int_{-\infty}^{\infty} X(\omega) e^{j\omega t} d\omega$$

#### 2. 离散傅里叶变换 (Discrete Fourier Transform, DFT)

对于一个离散时间序列 $x[n]$（例如数字信号），其离散傅里叶变换 $X[k]$ 定义为：

$$X[k] = \sum_{n=0}^{N-1} x[n] e^{-j\frac{2\pi}{N}kn}$$

其中：

- $x[n]$ 是离散时域序列，共 $N$ 个样本。
- $X[k]$ 是离散频域序列，代表第 $k$ 个频率分量。
- $N$ 是样本总数。
- $k$ 是频率索引，取值范围为 $0, 1, \dots, N-1$。

其逆离散傅里叶变换定义为：

$$x[n] = \frac{1}{N} \sum_{k=0}^{N-1} X[k] e^{j\frac{2\pi}{N}kn}$$

##### 离散傅里叶变换中的频率

这里的整数索引 $k$ **不是直接的频率值（例如赫兹 Hz）**，而是一个**频率“箱”的索引（bin index）**。每个 $k$ 值都对应着一个特定的物理频率。这个物理频率可以由以下公式计算得出：

$$f_k = k \cdot \frac{F_s}{N} \quad \text{其中 } k = 0, 1, \dots, N-1$$

其中：

- **$f_k$** 是 $X[k]$ 对应的实际频率，单位是赫兹 (Hz)。
- **$k$** 是 DFT 输出的频率索引，取值范围是 $0, 1, \dots, N-1$。
- **$F_s$** 是**采样频率 (Sampling Frequency)**，单位是赫兹 (Hz)，表示每秒采集的样本数。
- **$N$** 是进行 DFT 变换的样本总数（即输入序列 $x[n]$ 的长度）。

让我们来拆解这个公式的含义：

- **$k=0$** 对应的频率 $f_0 = 0 \cdot \frac{F_s}{N} = 0 \text{ Hz}$。这代表了信号中的 **DC (直流) 分量**，也就是信号的平均值。
- **$k=1$** 对应的频率 $f_1 = 1 \cdot \frac{F_s}{N} \text{ Hz}$。这是 DFT 能够分辨的**最低非零频率**，通常称为**频率分辨率 (Frequency Resolution)** 或**频率步长 (Frequency Bin Width)**。它表示每个频率“箱”之间的频率间隔。
- 随着 $k$ 的增加，$f_k$ 也随之增加，表示更高频率的成分。

##### 奈奎斯特采样定理

另外根据**奈奎斯特采样定理 (Nyquist Sampling Theorem)**，为了避免**混叠 (Aliasing)**，我们能从离散信号中恢复的最高频率是采样频率的一半，即**奈奎斯特频率 (Nyquist Frequency)** $F_{Nyquist} = F_s / 2$。

奈奎斯特采样定理告诫我们，如果原始模拟信号中包含**高于 $F_s/2$ 的频率成分**，那么这些高频成分在采样后会**混叠**到低于 $F_s/2$ 的频率上。

当 $k = N-1$ 时计算出的 $f_k \approx F_s$ 并不是因为原始信号中存在接近 $F_s$ 的频率并被正确采样了。**它是一个数学上的表示，对应于最低有效频率的负频率分量。**

如果你的原始模拟信号中确实包含频率超过 $F_s/2$ 的成分，那么这些频率在采样后会“折叠”回来，显示在 $0$ 到 $F_s/2$ 的频率区间内，这就是混叠。DFT 会忠实地反映出这些混叠后的频率成分。

- $X[k]$ 中 $k=N-1$ 对应的频率 $f_{N-1} = F_s - \frac{F_s}{N}$ **不应该被理解为原始信号中一个接近采样频率的物理频率分量**。
- 对于实数输入信号，DFT 频谱在奈奎斯特频率 $F_s/2$ 处是**对称的**。因此，$f_{N-1}$ 实际上对应的是最低非零频率 $f_1$ 的**负频率分量**（即 $-F_s/N$）。
- 奈奎斯特采样定理是在**采样过程**中就需要遵守的规则，以确保原始信号中的高频成分不会因为采样而混叠到低频。DFT 只是分析采样后的离散信号，它会揭示出任何**已经发生混叠**的频率。
