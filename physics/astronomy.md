# Astronomy

## 核心概念

参考[starwalk 的一个帖子](https://starwalk.space/zh-Hans/news/celestial-coordinates)

1.  **赤道坐标系（Equatorial Coordinate System）**:

    - **赤经 (Right Ascension, RA, α)**：天体沿着天赤道向东的角距离，以春分点为起点。通常用时、分、秒（h m s）表示。
    - **赤纬 (Declination, Dec, δ)**：天体相对于天赤道向北或向南的角距离。北为正，南为负，范围从 -90° 到 +90°。

> 天赤道和黄道的交点叫春分点和秋分点，区别在于，过春分点之后太阳直射的位置向北移动。因春分点不受地球自转的影响，所以赤经以春分点为起点，使得其坐标相对稳定。

2.  **地平坐标系（Horizontal Coordinate System）**:

    - **高度角 (Altitude, Alt, h)**：天体相对于观测者地平线的仰角。地平线为 0°，天顶为 90°。
    - **方位角 (Azimuth, Az, A)**：天体在地平线上相对于北点（通常）的水平角。通常从北点顺时针方向量度，范围从 0° 到 360°。

3.  **观测者位置**:

    - **地理纬度 (Latitude, φ)**：观测者所在地相对于地球赤道的南北距离。北纬为正，南纬为负。
    - **地理经度 (Longitude, λ)**：观测者所在地相对于本初子午线的东西距离。东经为正，西经为负。

4.  **时间系统**:

    - **世界时 (Universal Time, UT1)**：基于地球自转的平太阳时，与协调世界时（UTC）非常接近，对于大多数天文计算，UTC 可以作为 UT1 使用。
    - **儒略日期 (Julian Date, JD)**：从公元前 4713 年 1 月 1 日格林威治中午 12 点开始计算的连续天数，方便天文计算。
    - **格林威治平均恒星时 (Greenwich Mean Sidereal Time, GMST)**：格林威治子午线上的恒星时，表示春分点相对于格林威治子午线的角距离。
    - **地方恒星时 (Local Sidereal Time, LST)**：观测者所在子午线上的恒星时，表示春分点相对于观测者子午线的角距离。
    - **时角 (Hour Angle, HA, H)**：天体相对于观测者子午线的角距离。它是连接赤道坐标系和地平坐标系的关键。

## 赤经赤纬

### 为什么赤经使用时分秒（h m s）？

1.  **与恒星时（Sidereal Time）的直接关联**:

    - **恒星时**是天文学中用来衡量天体相对于观测者位置的一种时间系统。当地球自转一周，天球上的某个点（例如春分点）回到相同的位置时，就过去了 24 小时的恒星时。
    - **赤经与恒星时的关系非常直接**：一个天体的赤经值，就对应着当这个天体经过观测者的子午线（也就是天空正南方）时，当时的**地方恒星时**。
    - 将赤经表示为时分秒，使得天文学家可以更直观地知道一个天体何时会出现在天空中特定的位置（例如，当地方恒星时等于某颗星的赤经时，这颗星就正好过中天）。这在天文观测中非常方便，因为它直接与观测时间挂钩。

2.  **方便计算和观测**:
    - 整个天球被划分为 24 小时的赤经，而不是 360 度。这样一来，天体在天空中的相对运动（由于地球自转）就可以直接以时间来衡量。
    - 这种表示方法在设计和使用赤道仪（一种让望远镜能追踪天体运动的装置）时也特别方便，因为赤道仪的轴通常就是按照小时来刻度的。

- **1 小时（h）赤经 = 360° / 24 = 15 度（°）**
- **1 分钟（m）赤经 = 15° / 60 = 0.25 度（°） = 15 角分（′）**
- **1 秒（s）赤经 = 15° / 3600 = 0.004166... 度（°） = 15 角秒（″）**

> 1 度（°） = 60 角分（′）
> 1 角分（′） = 60 角秒（″）

## 计算星星相对于观测者的方向

要计算星星相对于观测者的方向，我们需要将星星的赤道坐标（赤经和赤纬）转换为地平坐标（方位角和高度角）。

### 需要的参数

- **星星的赤经 (Right Ascension, $\alpha$)**：星星在天球赤道坐标系中的经度，通常以小时、分钟、秒表示，这里我们将其转换为度，用$\alpha_{deg}$表示。
- **星星的赤纬 (Declination, $\delta$)**：星星在天球赤道坐标系中的纬度，以度、分、秒表示。
- **观测者的纬度 ($\phi$)**：观测者所在地理位置的纬度，北半球为正，南半球为负。
- **观测者的经度 ($\lambda$)**：观测者所在地理位置的经度，通常东经为正，西经为负。
- **当前时间 (UT1)**：世界时（Universal Time 1），通常以公历日期和时分秒表示。

### 计算步骤与公式

#### 1. 计算儒略日期 (Julian Date, JD)

> 从公元前 4713 年 1 月 1 日格林威治中午 12 点开始计算的连续天数

将当前时间转化为儒略日期的形式，用$JD$表示

#### 2. 计算格林尼治恒星时 (Greenwich Mean Sidereal Time, GMST)

GMST 是衡量地球相对于春分点自转的角度（这里单位为度）。它与儒略日期相关：

$GMST = 280.46061837 + 360.98564736629 \times (JD - 2451545.0) + 0.000387933 \times (JD - 2451545.0)^2 - (JD - 2451545.0)^3 / 38710000$

如果 $GMST < 0$，则 $GMST = GMST + 360$。
如果 $GMST \ge 360$，则 $GMST = GMST - 360$。

#### 4. 计算本地恒星时 (Local Sidereal Time, LST)

LST 是观测者所在地子午线相对于春分点的角度（这里单位为度）。它通过 GMST 和观测者的经度计算：

$LST = GMST + \lambda$

如果 $LST < 0$，则 $LST = LST + 360$。
如果 $LST \ge 360$，则 $LST = LST - 360$。

#### 5. 计算时角 (Hour Angle, H)

时角是星星相对于观测者当地子午线的角度（这里单位为度）。它是 LST 和星星赤经的差：

$H = LST - \alpha_{deg}$

如果 $H < -180$，则 $H = H + 360$。
如果 $H \ge 180$，则 $H = H - 360$。

#### 6. 计算高度角 (Altitude, $h$)

高度角是星星相对于地平线的垂直角度。地平线以上为正，以下为负。

$\sin(h) = \sin(\phi) \times \sin(\delta) + \cos(\phi) \times \cos(\delta) \times \cos(H)$

$h = \arcsin(\sin(h))$

#### 7. 计算方位角 (Azimuth, $A$)

方位角是星星相对于正北方向的水平角度，通常从正北方向顺时针测量。

$\sin(A) = -\cos(\delta) \times \sin(H) / \cos(h)$
$\cos(A) = (\sin(\delta) - \sin(h) \times \sin(\phi)) / (\cos(h) \times \cos(\phi))$

基于 $\sin(A)$ 和 $\cos(A)$ 的值，可以确定正确的方位角 $A$。

- 如果 $\sin(A) > 0$ 且 $\cos(A) > 0$，则 $A$ 处于第一象限。
- 如果 $\sin(A) > 0$ 且 $\cos(A) < 0$，则 $A$ 处于第二象限。
- 如果 $\sin(A) < 0$ 且 $\cos(A) < 0$，则 $A$ 处于第三象限。
- 如果 $\sin(A) < 0$ 且 $\cos(A) > 0$，则 $A$ 处于第四象限。

更简洁的计算方法是使用 `atan2` 函数：

$A = \operatorname{atan2}(-\sin(H) \times \cos(\delta), \sin(\delta) \times \cos(\phi) - \cos(\delta) \times \sin(\phi) \times \cos(H))$

请注意，`atan2` 函数返回的通常是弧度值，并且范围在 $-\pi$ 到 $\pi$ 之间。需要将其转换为 $0$ 到 $360$ 度，并根据约定进行调整（例如，通常方位角以北为 $0^\circ$，向东为正）。

- 如果 $A < 0$，则 $A = A + 360$。

### 结果解释

- **高度角 ($h$)**：表示星星在地平线以上的高度。如果 $h$ 为正值，星星可见；如果为负值，星星在地平线以下。
- **方位角 ($A$)**：表示星星在水平方向上的位置。通常，方位角以正北为 $0^\circ$，正东为 $90^\circ$，正南为 $180^\circ$，正西为 $270^\circ$。

### 注意事项

- 所有角度值在计算过程中应保持一致的单位（弧度或度）。通常，三角函数库使用弧度，因此在代入公式前可能需要进行单位转换 ($度 \times \pi / 180 = 弧度$)，并在获得结果后再转换回度数。
- 上述公式假设了理想条件，未考虑大气折射、章动、岁差等效应。对于高精度计算，需要纳入这些修正。
- 确保正确处理观测者经度的符号约定（东经为正，西经为负）。
- 时间的精确性至关重要，特别是对于快速移动的天体或需要高精度的观测。

通过以上步骤和公式，您可以计算出任何给定时间和地点，星星相对于观测者的地平坐标。

## 岁差 (Precession)

岁差是地球自转轴在太阳和月球引力作用下，在空间中绕着黄道北极缓慢地周期性运动，周期约为 25800 年。这种长期运动导致天球赤道面和春分点在天球背景上缓慢移动，从而改变了恒星的赤道坐标（赤经和赤纬）。岁差效应是长期性的，它使得不同年代的星表需要进行岁差修正才能进行比较。

## 星星的自行 (Proper Motion)

- `mα` (`unit.HourAngle`)
- `mδ` (`unit.Angle`)

它们代表的是星星的**自行 (Proper Motion)**。
它描述了恒星在**天球上随着时间推移而发生的视运动**。换句话说，它是恒星在天球上横向（垂直于视线方向）移动的角速度。

恒星在宇宙中是真实移动的，它们的总空间速度可以分解为两个分量：

1.  **径向速度 (Radial Velocity)**：沿着视线方向的运动，通过多普勒效应测量（谱线红移或蓝移）。
2.  **切向速度 (Tangential Velocity)**：垂直于视线方向的运动，表现为恒星在天球上的自行。

- `mα` ：表示恒星在**赤经 (Right Ascension)** 方向上的自行。它的单位通常是“角秒每年 (arcseconds per year)”或“毫角秒每年 (milliarcseconds per year)”

  - **注意**：严格来说，赤经方向的自行通常乘以 $cos(\delta)$ 来成为一个真正的角速度分量

- `mδ` ：表示恒星在**赤纬 (Declination)** 方向上的自行。它的单位通常也是“角秒每年”或“毫角秒每年”
